macro index <f1> ":source $XDG_CONFIG_HOME/mutt/account.mythic-beasts<enter><change-folder>+INBOX<enter>"
macro index <f2> ":source $XDG_CONFIG_HOME/mutt/account.tarandy<enter><change-folder>+INBOX<enter>"
macro index <f3> ":source $XDG_CONFIG_HOME/mutt/account.imperial<enter><change-folder>+INBOX<enter>"

bind editor <space> noop  # needed to switch to folder name with space in it
folder-hook . 'macro index,pager ! "<change-folder>$spoolfile<enter>"'
folder-hook . 'macro index,pager < "<change-folder>$record<enter>"'
folder-hook . 'macro index,pager c "<change-folder>$folder/<tab><tab>"'
folder-hook . 'macro index,pager C "<copy-message>$folder/<tab><tab>"'

bind generic,index \cA first-entry
bind generic,index \cE last-entry
bind generic,index,pager \cF next-page
bind generic,index,pager \cB previous-page
bind generic,index N search-opposite
bind pager N search-reverse

bind index,pager J sidebar-next
bind index,pager K sidebar-prev
bind index,pager <space> sidebar-open
bind index <up> previous-entry
bind index <down> next-entry

bind index \cU toggle-new
bind pager \cU mark-as-new
bind index G sync-mailbox
macro index L "<limit>all<enter><collapse-all>"

macro compose a "<attach-file>~/<tab><tab>"
bind compose d detach-file
bind compose A edit-description
macro attach s "<save-entry>~/Desktop<enter>y<enter>"

macro index $ "<shell-escape>pkill -SIGUSR1 -f offlineimap<enter>"

macro index,pager \cL "<pipe-message>mutt-to-things.py -q<enter>"

# notmuch searching and reconstituting
macro index / "<shell-escape>mutt-notmuch.py ${XDG_CACHE_HOME}/mutt/notmuch-results<enter><change-folder-readonly>${XDG_CACHE_HOME}/mutt/notmuch-results<enter>"
# Part of the reason this is so convoluted is:
# 1. <change-folder>`output of some command`<enter> does not work
# 2. source file doesn't seem to execute further commands after push <change-folder>
folder-hook . 'bind index,pager @ noop'
folder-hook notmuch-results "macro index,pager @ '<pipe-message>cat > ${XDG_CACHE_HOME}/mutt/recon-msg<enter><shell-escape>${XDG_CONFIG_HOME}/mutt/recon-msg.sh<enter><enter-command>\`head -n 1 ${XDG_CACHE_HOME}/mutt/recon-msg-details\`<enter><enter-command>\`head -n 2 ${XDG_CACHE_HOME}/mutt/recon-msg-details | tail -n 1\`<enter><enter-command>\`tail -n 1 ${XDG_CACHE_HOME}/mutt/recon-msg-details\`<enter>'"

# vim: filetype=muttrc
